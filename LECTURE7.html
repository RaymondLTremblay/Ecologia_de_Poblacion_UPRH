<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="BIOL4558" />


<title>Modelos de matrices poblacionales</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> BIOL4458</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Calendario</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Conferencias
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introducción a BIOL4458</a>
    </li>
    <li>
      <a href="LECTURE1_2.html">Un enfoque de sistemas holístico</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introducción a la Ecología de Poblaciones</a>
    </li>
    <li>
      <a href="LECTURE3_2.html">Thomas Robert Malthus</a>
    </li>
    <li>
      <a href="LECTURE4.html">Regulación de Poblaciones</a>
    </li>
    <li>
      <a href="LECTURE5.html">Paloma Viajera</a>
    </li>
    <li>
      <a href="LECTURE6.html">Población estructurada por Edad</a>
    </li>
    <li>
      <a href="LECTURE6a.html">Dinamica Poblacional en Orquideas</a>
    </li>
    <li>
      <a href="LECTURE7.html">Modelos de población usando Matrices</a>
    </li>
    <li>
      <a href="Lepanthes_rubripetala_4.html">Modelos matriciales de una orquidea</a>
    </li>
    <li>
      <a href="LECTURE8.html">Modelos Estochasticos de poblaciones</a>
    </li>
    <li>
      <a href="LECTURE9.html">El paradigma de pequeñas poblaciones</a>
    </li>
    <li>
      <a href="LECTURE10.html">Modelos individuales</a>
    </li>
    <li>
      <a href="LECTURE11.html">El paradigma de poblaciones en reducción</a>
    </li>
    <li>
      <a href="LECTURE12.html">PVA = Population Viability Analysis</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="LECTURE15.html">Estimados de parametros</a>
    </li>
    <li>
      <a href="LECTURE16.html">Interaciones entre especies: competencia</a>
    </li>
    <li>
      <a href="LECTURE17.html">Interaciones entre especies: presa-depredador</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tareas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Tarea_1_historia_vida.html">Tarea 1: Historia de Vida</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Invitados
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Invitados.html">Lecturas de los Invitados</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejemplos de proyecto de PVA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="PVA_Ejemplos.html">PVA por los estudiantes</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Modelos de matrices poblacionales</h1>
<h4 class="author">BIOL4558</h4>
<h4 class="date">Agosto 2021</h4>

</div>


<div id="próximo-examen-parcial-some-date" class="section level3">
<h3>Próximo examen parcial some date</h3>
<p>Test date in the future real soon</p>
<p>No texto</p>
<p>El 6 de octubre</p>
<p><strong>cuándo y dónde</strong> El primer examen parcial (de dos) se realizará el lunes <strong>15 de marzo</strong>. Tendrás todo el período de clase de 120 minutos para realizar el examen. El examen será en línea (por supuesto) y se administrará en Edmodo.</p>
<p><strong>qué </strong> El examen cubrirá:</p>
<ul>
<li>Todo el material de los capítulos 1-3 del libro de Gotelli <em>incluidos los conceptos de modelos de población matricial </em>.</li>
<li>Todo el material cubierto en conferencias hasta e incluyendo esta conferencia sobre modelos matriciales de población.</li>
<li>Ch. 1 de “Beyond Connecting the Dots” (pensamiento sistémico básico y modelado de flujo de existencias, conceptos de retroalimentación y equilibrios)</li>
<li>Conceptos básicos de programación (IF-THEN-ELSE y de iteración)</li>
</ul>
<p><em>El examen consistirá en una combinación de preguntas de opción múltiple y de respuesta corta.</em></p>
<p><em>Por favor traiga una calculadora; una calculadora científica normal está bien (no es absolutamente necesaria, ¡pero podría ser útil para al menos una pregunta del examen!)</em></p>
</div>
<div id="matrix-population-models" class="section level1">
<h1>Matrix population models</h1>
<p>En primer lugar, esta lección está llena de código R (¡R es bastante bueno para ejecutar modelos de población matricial!). Si desea seguir en R, puede encontrar el script R <a href="LECTURE7.R">aquí</a>. Recomiendo hacer clic derecho en el enlace, guardar el script en una carpeta designada y cargar el script en RStudio.</p>
<div id="por-qué-matrices" class="section level2">
<h2>¿Por qué matrices?</h2>
<div id="reason-1-simplify" class="section level3">
<h3>Reason 1: simplify!</h3>
<p><img src="figures/IM8.jpg" /></p>
<p>Es posible que reconozca este modelo de InsightMaker. Esto representa una población estructurada por edad con solo tres clases de edad. Imagínese si hubiera cinco clases de edad o diez. ¿Qué pasaría si pudieras saltar de (por ejemplo) la etapa 3 a la etapa 5? ¿O de la etapa 5 a la etapa 3? ¿Cuántas líneas tendrías que dibujar, cuántas ecuaciones tendrías que poner en todos los diferentes flujos? Sería tedioso y fácilmente podría encontrarse con errores que serían muy difíciles de depurar.</p>
<p><img src="figures/teasel1.jpg" /></p>
<p>Considere el ejemplo del teasel de nuestro libro de texto. Es posible implementar este modelo en InsightMaker, pero sería tedioso y potencialmente propenso a errores. Y esto está lejos de las poblaciones más complicadas que existen (aunque observe que las plantas pueden hacer algunas cosas que los animales no pueden hacer, por ejemplo, retroceder en la etapa de desarrollo. ¡Con los modelos matriciales, hay una manera más fácil!</p>
<p><img src="figures/gotelli3_6.jpg" /></p>
<p>Las tasas vitales de la población para casi cualquier población estructurada por edad o estructurada por etapas se pueden representar como una <strong>matriz de transición</strong> (o matriz de proyección), que resume toda la información sobre mortalidad, tasas de natalidad y transiciones entre etapas. (¡y el hecho de que una historia de vida como Teasel pueda representarse mediante una matriz de transición ilustra la generalidad de este concepto!)</p>
<p>Por ejemplo, las tasas vitales de teasel se pueden resumir en <a href="teaselmatrix1.csv">esta matriz</a>:</p>
<pre class="r"><code>#########
# Teasel example from Gotelli: summarizing a complex life history!

teasel &lt;- read.csv(&quot;teaselmatrix1.csv&quot;, header=T)      # read in the teasel transition matrix from Gotelli
teasel &lt;- teasel[,-1]                                  # remove the row names
teasel_matrix &lt;- as.matrix(teasel)                     # convert to a matrix (from a data frame)
colnames(teasel_matrix) &lt;- names(teasel)               # assign row and column names
rownames(teasel_matrix) &lt;- names(teasel)
teasel_matrix                                          # print the matrix</code></pre>
<pre><code>##           seed1 seed2  ros1  ros2  ros3 flowering
## seed1     0.000  0.00 0.000 0.000 0.000   322.380
## seed2     0.966  0.00 0.000 0.000 0.000     0.000
## ros1      0.013  0.01 0.125 0.000 0.000     3.448
## ros2      0.007  0.00 0.125 0.238 0.000    30.170
## ros3      0.008  0.00 0.000 0.245 0.167     0.862
## flowering 0.000  0.00 0.000 0.023 0.750     0.000</code></pre>
<p>¿No es eso *elegante *?</p>
<p>¡Entraremos en más detalles sobre las matrices más adelante!</p>
</div>
<div id="supplementario-matrices-estructura-por-etapas-vs.-estructura-por-edades" class="section level3">
<h3>Supplementario: Matrices estructura por etapas vs. estructura por edades</h3>
<p>En la conferencia anterior, hablamos de ‘poblaciones estructuradas por edad’. Lo que queremos decir con eso es que las tasas vitales de la población (por ejemplo, nacimiento y mortandad) variaban según la edad.</p>
<p>A veces, es conveniente clasificar a los individuos dentro de un cierto rango de edad como pertenecientes a una etapa particular de su historia de vida. Por ejemplo, podríamos clasificar la historia de vida de un oso pardo así:</p>
<p>Edad 0-1: recien nacidos<br />
Edad 1-2: juveniles<br />
Edad 2-5: sub-adulto<br />
Edad 6+: adulto</p>
<p>Esto puede simplificar nuestros modelos considerablemente. Por ejemplo, considere una especie como una tortuga marina, con hasta 75 o 100 años de vida. Podría construir un modelo en el que tenga 100 acciones, una por cada año de vida. O, podría tener 5 o más poblaciones que representen rangos de edad en los que las tortugas marinas tienden a tener tasas vitales consistentes (mas o menos). Por ejemplo, podríamos dividir la historia de vida de las tortugas marinas en las siguientes etapas:</p>
<p>Edad 0-1: recien nacidos<br />
Edad 1-5: juveniles joven<br />
Edad 5-10: juvenile más grandes<br />
Edad 10-17: sub-adult0<br />
Edad 18+: adult0</p>
<p>Al usar etapas, hemos simplificado nuestro modelo de tener 100 acciones (con aún más flujos / transiciones asociadas) a un modelo con solo 5 acciones, y todavía estamos capturando cómo cambian las tasas vitales con la edad (el modelo sigue siendo biológicamente realista).</p>
<p>Los modelos matriciales de población pueden representar modelos estructurados por edades y estructurados por etapas con la misma simplicidad y elegancia.</p>
<p>La ‘Leslie Matrix’ comúnmente utilizada se refiere a un modelo de población matricial que representa una población estructurada por edad. Cuando se utiliza una matriz para representar una población estructurada por etapas, a menudo se la denomina Matriz ‘Lefkovitch’.</p>
</div>
<div id="razón-2-proyección" class="section level3">
<h3>Razón 2: ¡proyección!</h3>
<p>En una de las preguntas del laboratorio 3, se le pidió que usara una tabla de vida para proyectar la estructura de edad de una población en un paso de tiempo en el futuro. ¿Fue sencillo y directo hacer esto? (respuesta: ¡¡NO !!)</p>
<p>Las tablas de vida son excelentes para resumir los cronogramas de supervivencia y otros aspectos de las poblaciones estructuradas por edad. ¡Pero las <em>tablas de vida no son excelentes para proyectar la abundancia estructurada por edades en el futuro</em>!</p>
<p>¿Sabes qué <em>es</em> genial para proyectar la abundancia estructurada por edades en el futuro? (respuesta obvia: MATRICES!)</p>
<p>Por ejemplo, proyectemos una población de teasel 1 año en el futuro:</p>
<p>En primer lugar, debemos comenzar con una población de teasel <strong>vector </strong> …</p>
<pre class="r"><code>#############
# Summarize initial age-structured abundance as a matrix with one column

Initial_teasel &lt;- matrix(c(1000,1500,200,300,600,25),ncol=1)         # initial population size (population vector; matrix with 1 column!)
rownames(Initial_teasel) &lt;- rownames(teasel_matrix)                  # add row and column names
colnames(Initial_teasel) &lt;- &quot;Abundance&quot;
Initial_teasel</code></pre>
<pre><code>##           Abundance
## seed1          1000
## seed2          1500
## ros1            200
## ros2            300
## ros3            600
## flowering        25</code></pre>
<p>¡Entonces todo lo que tenemos que hacer es ‘multiplicar por matriz’ este <strong>vector </strong> de abundancias por la <strong>matriz de transición </strong> de arriba! ¡Cada vez que hacemos este paso de multiplicación, avanzamos un año! ¡Es fácil!</p>
<p>NOTA: la multiplicación de matrices (porcentaje-asterisco-porcentaje en R) no es lo mismo que la multiplicación estándar (asterisco en R). Repasaremos esto en la introducción al laboratorio 4 un poco más adelante.</p>
<p>¡Así es como podemos hacer esto en R!</p>
<pre class="r"><code>#########
# Project the population at time 1

Year1 &lt;- teasel_matrix %*% Initial_teasel   # note: the &#39;%*%&#39; denotes &#39;matrix multiplication&#39; in R. We&#39;ll go through this more later.     
Year1</code></pre>
<pre><code>##           Abundance
## seed1       8059.50
## seed2        966.00
## ros1         139.20
## ros2         857.65
## ros3         203.25
## flowering    456.90</code></pre>
<p>¿Qué tan fácil es eso ?</p>
<p>Para calcular la abundancia de carmesí en el año 2 de nuestra simulación, simplemente podemos repetir:</p>
<pre class="r"><code>#########
# Project the population at time 2

thisYear &lt;- Year1
nextYear &lt;- teasel_matrix %*% thisYear
nextYear  # now we get the (age structured) population size at time 2!     </code></pre>
<pre><code>##             Abundance
## seed1     147295.4220
## seed2       7785.4770
## ros1        1707.2247
## ros2       14062.6102
## ros3         702.3908
## flowering    172.1635</code></pre>
<p>Podríamos usar esta estrategia para simular la abundancia durante diez años (o 20, o 30, o 10000) …</p>
<p>¡Observe el uso de un <strong>loop </strong> aquí!</p>
<pre class="r"><code>########
# Use a for loop to project the population dynamics for the next 10 years!

nYears &lt;- 10
tenYears &lt;- matrix(0,nrow=6,ncol=nYears+1)          # initialize storate array for recording age structured abundances for the next 10 years. 
rownames(tenYears) &lt;- rownames(Initial_teasel)      # assign row and column names
colnames(tenYears) &lt;- seq(0,10)
tenYears[,1] &lt;- Initial_teasel                      # initialize the simulated abundances


##########
# run the for loop!

for(t in 2:(nYears+1)){    # here we use &#39;t&#39; as our looping variable, but we could choose any name we want
  tenYears[,t] &lt;-  teasel_matrix %*% tenYears[,t-1]     # perform matrix multiplication for each year of the simulation!
}

tenYears</code></pre>
<pre><code>##              0       1           2           3          4           5
## seed1     1000 8059.50 147295.4220  55502.0530 274098.158 1254742.541
## seed2     1500  966.00   7785.4770 142287.3777  53614.983  264778.821
## ros1       200  139.20   1707.2247   2799.7179   5425.969   18197.711
## ros2       300  857.65  14062.6102   9785.5436  28718.972  126857.393
## ros3       600  203.25    702.3908   4889.4070   4390.907   13317.225
## flowering   25  456.90    172.1635    850.2331   3892.123    3953.716
##                    6          7           8          9         10
## seed1     1274599.05 4160519.75 12493783.29 19821259.9 54739267.1
## seed2     1212081.29 1231262.68  4019062.08 12068994.7 19147337.1
## ros1        34866.57   77547.56   209719.50   440822.1  1018930.3
## ros2       160533.59  440850.62  1312972.86  2281135.7  5859547.7
## ros3        46750.08   68459.45   186131.95   505712.0   948267.5
## flowering   12905.64   38754.83    61484.15   169797.3   431750.1</code></pre>
<p>¡Finalmente, podemos trazar la abundancia de cada etapa durante 10 años!</p>
<p><img src="LECTURE7_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>¡Así que la proyección es fácil con matrices!</p>
</div>
<div id="razón-3-trucos-de-álgebra-matricial" class="section level3">
<h3>Razón 3: ¡Trucos de álgebra matricial!</h3>
<p>Existe una clara similitud entre la ecuación de crecimiento de la población finita:</p>
<p><span class="math inline">\(N_{t+1}=\lambda \cdot N_t\)</span>,</p>
<p>donde $N $ es abundancia (como siempre), <span class="math inline">\(t\)</span> es el tiempo, a menudo en años, pero podría ser cualquier unidad de tiempo, y <span class="math inline">\(\lambda\)</span> es la tasa de crecimiento multiplicativo durante el período de tiempo <span class="math inline">\(t \ rightarrow t + 1\)</span></p>
<p>… y la ecuación matricial de crecimiento de la población:</p>
<p><span class="math inline">\(\mathbf{N}_{t+1} = \mathbf{A} \cdot \mathbf{N}_{t}\)</span>,</p>
<p>donde <span class="math inline">\(\mathbf {N}\)</span> es un ** vector ** de abundancias (abundancia para todas las etapas), y <span class="math inline">\(\mathbf{A}\)</span> es la <strong>matriz de transición</strong>, que hemos visto antes.</p>
<p><strong>Q:</strong> ¿Puedes ver la similitud entre estas dos ecuaciones?</p>
<p>Ambas ecuaciones describen un crecimiento o una disminución exponencial simple.</p>
<p><strong>Q:</strong> ¿Puedes ver la diferencia entre estas dos ecuaciones?</p>
<p>Tenga en cuenta que $N $ en la primera ecuación es un <strong>escalar </strong>, es decir, es solo un número desnudo sin componentes adicionales.</p>
<p>MIENTRAS QUE,</p>
<p><span class="math inline">\(\mathbf{N}\)</span> en la segunda ecuación es un <strong>vector </strong> estructurado por edad: un conjunto de abundancias estructurado por edad o clase de etapa.</p>
<p>De manera similar, la tasa de crecimiento de la población finita, $$ es un escalar,</p>
<p>MIENTRAS QUE,</p>
<p>$ $ es una <strong>matriz </strong> (la matriz de transición)</p>
<div id="qué-pasa-con-esos-trucos-que-prometiste" class="section level4">
<h4>¿Qué pasa con esos trucos que prometiste?</h4>
<p>Okay one of the tricks is this:</p>
<p>In one step, you can compute <span class="math inline">\(\lambda\)</span> from <span class="math inline">\(\mathbf{A}\)</span>!!</p>
<p>All you need to do is obtain the <em>first, or dominant, <strong>eigenvalue</strong> of <span class="math inline">\(\mathbf{A}\)</span></em>! This number is the finite rate of growth, <span class="math inline">\(\lambda\)</span>, for an age or stage-structured population.</p>
<p>Recall that when a population is at stable age distribution, it grows in a discrete exponential growth pattern- this rate of exponential growth can be described by a single parameter – Lambda!</p>
<p>¡Hagamos esto en R!</p>
<p>¿Cuál es la tasa de crecimiento $  lambda $ para la población de teasel? Si recuerda, parecía que estaba creciendo, por lo que debería estar por encima de 1 …</p>
<pre class="r"><code>###########
#  Utilice la matriz de transición para calcular Lambda, o la tasa finita de crecimiento de la población.

Lambda &lt;- as.numeric(round(eigen(teasel_matrix)$values[1],2))
Lambda</code></pre>
<pre><code>## [1] 2.32</code></pre>
<p>O podríamos usar el paquete “popbio” en R:</p>
<pre class="r"><code>library(popbio)      # or... it&#39;s easier to use the &#39;popbio&#39; library in R!
lambda(teasel_matrix)</code></pre>
<pre><code>## [1] 2.32188</code></pre>
<p>No es necesario que comprenda las matemáticas aquí, pero quiero que comprenda lo simple que fue, ¡solo una línea de código y calculamos la tasa anual de crecimiento a partir de la matriz de transición de teasel!</p>
<p>Aquí hay otro truco ingenioso:</p>
<p>En un solo paso, puede calcular <strong>distribución de edad estable (S.A.D)</strong> a partir de <span class="math inline">\(\mathbf{A}\)</span>!!</p>
<p>¡Todo lo que necesita hacer es obtener el <em>eigenvectoc derecho de <span class="math inline">\(\mathbf{A}\)</span></em>! Este vector representa las abundancias relativas en cada clase de edad en la distribución de edad estable.</p>
<p>¡Hagamos esto en R!</p>
<p>¿Cuál es la distribución de edad estable para la población de cardo? Si recuerda, la primera etapa inicial parecía dominar en la figura anterior.</p>
<pre class="r"><code>##########
# Calcule la distribución de edad estable a partir de la matriz de transición

SAD &lt;- abs(as.numeric(round(eigen(teasel_matrix)$vectors[,1],3)))
SAD/sum(SAD)      # stable age distribution as a percentage of the total population</code></pre>
<pre><code>## [1] 0.636615811 0.264909847 0.012482663 0.069348128 0.011789182 0.004854369</code></pre>
<p>O podríamos usar el paquete “popbio” en R:</p>
<pre class="r"><code>library(popbio)    # ... y es aún más fácil si usamos el paquete &#39;popbio&#39;...
stable.stage(teasel_matrix)</code></pre>
<pre><code>##       seed1       seed2        ros1        ros2        ros3   flowering 
## 0.636901968 0.264978062 0.012174560 0.069281759 0.012076487 0.004587164</code></pre>
<p><strong>Q:</strong> ¿Una población estructurada por etapas crece a una tasa de $  lambda $ por paso de tiempo si NO tiene una distribución de edad estable? [Edmodo]</p>
<p>Para responder a esta pregunta, puede que le resulte útil cargar un modelo estructurado por etapas en InsightMaker como <a href="https://insightmaker.com/insight/70809/Age-structured-population">this one</a>).</p>
</div>
</div>
</div>
<div id="mechanics-of-matrix-population-models" class="section level2">
<h2>Mechanics of matrix population models</h2>
<p>Echemos un vistazo a una población básica estructurada por edad, específicamente el ejemplo en clase de la última conferencia. (<a href="https://insightmaker.com/insight/70809/Age-structured-population">this one</a>.). Echemos un vistazo a una población básica estructurada por edad, específicamente el ejemplo en clase de la última conferencia.</p>
<p><img src="figures/IM9.jpg" /></p>
<p>Convirtamos las tasas vitales a una <strong>matriz de proyección</strong> de tres etapas. Las matrices de proyección son <strong>matrices cuadradas</strong> donde el número de filas y columnas es igual al número de etapas de la vida. En este caso, ¡eso significa tres! Hagamos una matriz en blanco por ahora:</p>
<pre class="r"><code>###################
# Demostración en clase: convierta un modelo insightmaker en un modelo de proyección matricial


###########
# Primero, especificamos una matriz de transición en blanco

TMat &lt;- matrix(0,nrow=3,ncol=3)                    # create a blank matrix with 3 rows and 3 columns
stagenames &lt;- c(&quot;Juveniles&quot;,&quot;Subadults&quot;,&quot;Adults&quot;)  # name the rows and columns
rownames(TMat) &lt;- stagenames
colnames(TMat) &lt;- stagenames
TMat                                               # now we have an all-zero transition matrix.</code></pre>
<pre><code>##           Juveniles Subadults Adults
## Juveniles         0         0      0
## Subadults         0         0      0
## Adults            0         0      0</code></pre>
<p>Puede leer los <strong>elementos</strong> de una matriz de transición de la siguiente manera:</p>
<p>“La producción per cápita de <em>(nombre de la fila)</em> por <em>(nombre de la columna)</em> es <em>(valor del elemento)</em>”</p>
<p>Ahora podemos comenzar a completar esta matriz. Comencemos con el <strong>elemento </strong> superior izquierdo de la matriz. Esto representa la producción per cápita de Juveniles (col) por Juveniles (fila). ¿Cuál es el valor de este elemento?</p>
<p>Actualicemos nuestra matriz de transición:</p>
<pre class="r"><code>#####
# fill in the top left element of the matrix

TMat[1,1] &lt;- 0
TMat</code></pre>
<pre><code>##           Juveniles Subadults Adults
## Juveniles         0         0      0
## Subadults         0         0      0
## Adults            0         0      0</code></pre>
<p>¿Qué tal la segunda fila, la primera columna? Esto representa la producción per cápita de subadultos (fila) por juveniles del año anterior (col). Es decir, la tasa de transición de juvenil a subadulto. El valor de nuestro modelo es 0,3.</p>
<p>Actualicemos nuestra matriz de transición:</p>
<pre class="r"><code>#####
# actualizar la segunda fila, primera columna

TMat[2,1] &lt;- 0.3
TMat</code></pre>
<pre><code>##           Juveniles Subadults Adults
## Juveniles       0.0         0      0
## Subadults       0.3         0      0
## Adults          0.0         0      0</code></pre>
<p>Si continuamos, obtenemos la siguiente matriz. Vea si puede entender lo que dice esta matriz sobre las transiciones y dos de las tres etapas de la vida.</p>
<pre class="r"><code>#####
# y sigue llenándolo...

TMat[,1] &lt;- c(0,0.3,0)          # fill in the entire first column of the transition matrix
TMat[,2] &lt;- c(0,0.4,0.1)        # fill in the entire second column of the transition matrix
TMat[,3] &lt;- c(4,0,0.85)         # fill in the entire third column of the transition matrix
TMat</code></pre>
<pre><code>##           Juveniles Subadults Adults
## Juveniles       0.0       0.0   4.00
## Subadults       0.3       0.4   0.00
## Adults          0.0       0.1   0.85</code></pre>
<p>Ahora podemos ejecutar una proyección de 40 años y compararla con el modelo InsightMaker. ¡¡Será mejor que tenga el mismo aspecto !!</p>
<p>Primero debemos especificar las abundancias iniciales en cada etapa:</p>
<pre class="r"><code>######
# especificar vector de abundancia inicial

InitAbund &lt;- c(40,0,0)
names(InitAbund) &lt;- colnames(TMat)
InitAbund</code></pre>
<pre><code>## Juveniles Subadults    Adults 
##        40         0         0</code></pre>
<p>Así que empezamos solo con menores…</p>
<pre class="r"><code>#######
# Ejecute el modelo durante 40 años (usando for loop)

nYears &lt;- 40
allYears &lt;- matrix(0,nrow=nrow(TMat),ncol=nYears+1)
rownames(allYears) &lt;- rownames(TMat)
colnames(allYears) &lt;- seq(0,nYears)
allYears[,1] &lt;- InitAbund 

for(t in 2:(nYears+1)){
  allYears[,t] &lt;-  TMat %*% allYears[,t-1]
}

allYears</code></pre>
<pre><code>##            0  1   2    3     4       5        6        7        8        9
## Juveniles 40  0 0.0 4.80 6.000 5.86800 5.871000 6.063630 6.287558 6.502333
## Subadults  0 12 4.8 1.92 2.208 2.68320 2.833680 2.894772 2.976998 3.077066
## Adults     0  0 1.2 1.50 1.467 1.46775 1.515907 1.571889 1.625583 1.679445
##                 10       11       12       13       14       15       16
## Juveniles 6.717782 6.940941 7.172411 7.411727 7.658952 7.914392 8.178354
## Subadults 3.181526 3.287945 3.397460 3.510707 3.627801 3.748806 3.873840
## Adults    1.735235 1.793103 1.852932 1.914738 1.978598 2.044588 2.112781
##                 17       18       19       20       21       22        23
## Juveniles 8.451123 8.732991 9.024259 9.325242 9.636263 9.957658 10.289772
## Subadults 4.003042 4.136554 4.274519 4.417085 4.564407 4.716641  4.873954
## Adults    2.183248 2.256065 2.331310 2.409066 2.489414 2.572443  2.658241
##                  24        25        26        27        28        29        30
## Juveniles 10.632962 10.987600 11.354065 11.732753 12.124071 12.528440 12.946297
## Subadults  5.036513  5.204494  5.378077  5.557450  5.742806  5.934344  6.132270
## Adults     2.746900  2.838516  2.933188  3.031018  3.132110  3.236574  3.344522
##                  31        32        33        34        35        36        37
## Juveniles 13.378090 13.824284 14.285360 14.761814 15.254160 15.762926 16.288661
## Subadults  6.336797  6.548146  6.766543  6.992225  7.225434  7.466422  7.715446
## Adults     3.456071  3.571340  3.690454  3.813540  3.940731  4.072165  4.207983
##                  38        39        40
## Juveniles 16.831930 17.393319 17.973432
## Subadults  7.972777  8.238690  8.513472
## Adults     4.348330  4.493358  4.643223</code></pre>
<p>¡Ahora trazémoslo!</p>
<pre class="r"><code>#####
# and plot out the results!

plot(1,1,pch=&quot;&quot;,ylim=c(0,50),xlim=c(0,nYears+1),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;,xaxt=&quot;n&quot;)
cols &lt;- rainbow(3)
for(s in 1:3){
  points(allYears[s,],col=cols[s],type=&quot;l&quot;,lwd=2)
}
axis(1,at=seq(1,nYears+1),labels = seq(0,nYears))
legend(&quot;topleft&quot;,col=cols,lwd=rep(2,3),legend=rownames(allYears))</code></pre>
<p><img src="LECTURE7_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>¿Tiene el mismo aspecto que los resultados de InsightMaker?</p>
</div>
<div id="limitaciones-de-los-modelos-matriciales-de-población" class="section level2">
<h2>Limitaciones de los modelos matriciales de población</h2>
<p>Los modelos de población matricial son excelentes, pero también tienen algunas limitaciones.</p>
<div id="qué-pasa-con-la-dependencia-de-la-densidad" class="section level3">
<h3>¿Qué pasa con la dependencia de la densidad?</h3>
<p>De alguna manera, mientras introducimos un nuevo nivel de realismo en nuestros modelos, la estructura por edades, hemos estado ignorando otro tipo de realismo que introdujimos en conferencias anteriores: ¡<strong>dependencia de la densidad</strong>!</p>
<p>¿Qué tasas vitales dependen de la densidad? ¿Todas? ¿Algunos? ¿Depende? ¿Están disponibles los datos?</p>
<p>¿Cómo se incorpora la dependencia de la densidad en un modelo de población matricial?</p>
<p>¿Cómo se incorpora la dinámica depredador-presa en un modelo de población matricial? [señal de explosión cerebral]</p>
<p>¿Cómo incluir variación ambiental?</p>
<p>¿Cómo incluir variación espacial?</p>
<p>¿Considerando variación en las categorias?</p>
<p>¿Que haces cuando no hay información sobre una de los parametros de la matriz?</p>
<p><em>Todo lo que pueda hacer con un modelo de población matricial, también puede hacerlo en InsightMaker (o R, o cualquier otra plataforma de programación)</em> (¡pero puede que no sea tan ‘bonito’ o elegante como un modelo de población matricial!)</p>
<p>The reverse is NOT true: <strong>you can not always convert InsightMaker models to matrix population models</strong> (IM is a programming language, so is much more flexible!)</p>
</div>
<div id="repaso-de-la-multiplicación-de-matrices" class="section level3">
<h3>Repaso de la multiplicación de matrices</h3>
<p>(during lab!)</p>
</div>
<div id="ejercicio-en-clase-modelos-de-proyección-matricial" class="section level3">
<h3>Ejercicio en clase: modelos de proyección matricial</h3>
<p>Traduzca el siguiente párrafo a un modelo de población matricial. Recuerde que un modelo de población matricial tiene dos componentes: un ** vector de abundancia inicial ** y una ** matriz de transición **.</p>
<p>NOTA: ¡esta también es una pregunta en el laboratorio 4!</p>
<p><img src="figures/redtail1.jpg" /></p>
<blockquote>
<p>Asumimos que la historia de vida del halcón de cola roja podría describirse en términos de tres etapas principales de la vida: cría (primer año de vida), juvenil (principalmente individuos en su segundo año de vida) y adulto (generalmente el tercer año de vida). y más allá). Los adultos son la etapa reproductiva primaria y producen un promedio de 3 nuevas crías cada año. Se espera que los juveniles produzcan solo 1 cría nueva cada año. Asumimos que los adultos experimentaron un promedio de 18% de mortalidad cada año. La mortalidad juvenil se fijó en un 30% anual. Aproximadamente el 5% de los juveniles permanecen en la fase juvenil cada año, y todos los demás sobrevivientes pasan a la etapa adulta. Finalmente, las crías tenían un 20% de posibilidades de sobrevivir y hacer la transición para convertirse en juveniles. Inicializamos la población con 1000 crías, 150 juveniles y 5 adultos.</p>
</blockquote>
<p><strong>P: </strong> ¿Cómo se ve la matriz de transición? [EDMODO]</p>
<p><strong>P: </strong> ¿Cómo se ve el vector de abundancia de la etapa inicial?</p>
<p><strong>P: </strong> ¿Se encuentra esta población en una distribución por etapas estable?</p>
<p><strong>P: </strong> ¿Cuál es la tasa de crecimiento de esta población?</p>
<p>Para obtener más información sobre los modelos matriciales de población, la Biblia de este tema es <a href="https://www.amazon.com/gp/huc/view.html?ie=UTF8&amp;newItems=C1DH1414B1C6AK%2C1">this book by Hal Caswell</a>. Y finalmente, mira esto: esta es una base de datos de miles de matrices de etapas para plantas y animales en todo el mundo:</p>
<p><a href="https://compadredb.wordpress.com/2015/10/05/introducing-the-comadre-animal-matrix-database/">COMADRE and COMPADRE databases</a></p>
<p><a href="LECTURE8.html">–go to next lecture–</a></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
