<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="BIOL4558" />


<title>Lepanthes rubripetala</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/viz-1.8.2/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-1.0.11/grViz.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> BIOL4458</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Calendario</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Conferencias
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introducción a BIOL4458</a>
    </li>
    <li>
      <a href="LECTURE1_2.html">Un enfoque de sistemas holístico</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introducción a la Ecología de Poblaciones</a>
    </li>
    <li>
      <a href="LECTURE3_2.html">Thomas Robert Malthus</a>
    </li>
    <li>
      <a href="LECTURE4.html">Regulación de Poblaciones</a>
    </li>
    <li>
      <a href="LECTURE5.html">El efecto Allee</a>
    </li>
    <li>
      <a href="LECTURE6.html">Población estructurada por Edad</a>
    </li>
    <li>
      <a href="LECTURE6a.html">Dinamica Poblacional en Orquideas</a>
    </li>
    <li>
      <a href="LECTURE7.html">Modelos de población usando Matrices</a>
    </li>
    <li>
      <a href="Lepanthes_rubripetala_4.html">Modelos matriciales de una orquidea</a>
    </li>
    <li>
      <a href="LECTURE8.html">Modelos Estochasticos de poblaciones</a>
    </li>
    <li>
      <a href="LECTURE9.html">El paradigma de pequeñas poblaciones</a>
    </li>
    <li>
      <a href="LECTURE10.html">Modelos individuales</a>
    </li>
    <li>
      <a href="LECTURE11.html">El paradigma de poblaciones en reducción</a>
    </li>
    <li>
      <a href="LECTURE12.html">PVA = Population Viability Analysis</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="LECTURE15.html">Estimados de parametros</a>
    </li>
    <li>
      <a href="LECTURE16.html">Interaciones entre especies: competencia</a>
    </li>
    <li>
      <a href="LECTURE17.html">Interaciones entre especies: presa-depredador</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tareas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Tarea_1_historia_vida.html">Tarea 1: Historia de Vida</a>
    </li>
    <li>
      <a href="Tarea_Ballena.html">Tarea 2: Dinámica de Ballenas</a>
    </li>
    <li>
      <a href="Tarea_3_Paradigma_Poblacion_declive.html">Tarea 3: Paradigma de población en declive</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Proyecto Final</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Invitados
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Invitados.html">Lecturas de los Invitados</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Ejemplos de proyecto de PVA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="PVA_Ejemplos.html">PVA por los estudiantes</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lepanthes rubripetala</h1>
<h4 class="author">BIOL4558</h4>
<h4 class="date">Agosto 2021</h4>

</div>


<div id="appendix-s1" class="section level3">
<h3>APPENDIX S1</h3>
<ul>
<li>R code for figures</li>
<li>This appendix provides R code for producing the figures included in
the main manuscript.</li>
<li>Install the library using install.packages() or by downloading from
<a href="http://cran.R-project.org"
class="uri">http://cran.R-project.org</a></li>
</ul>
</div>
<div id="load-the-library" class="section level3">
<h3>Load the library</h3>
<pre class="r"><code>library(popdemo)
library(popbio)
#remotes::install_github(&quot;jonesor/Rage&quot;)</code></pre>
<p><em>Lepanthes</em> is one of the largest genera of the Orchidaceae
with &gt;1200 species, found only in the Neotropics.</p>
<hr />
<p>Here is photo of the flower of <em>Lepanthes rubripetala</em>,</p>
<div class="float">
<img src="figures/Lepanthes_rubripetala.png"
alt="Lepanthes rubripetala" />
<div class="figcaption">Lepanthes rubripetala</div>
</div>
<p>A population of <em>Lepanthes rupestris</em>, those of <em>Lepanthes
rubripetala</em> growth in the same way (on rocks or trees), so these
groups of individuals are discrete and may be seperated by large
distances.</p>
<hr />
<div class="float">
<img
src="figures/Lepanthes-rupestris-on-a-boulder-along-Quebrada-Sonadora-in-the-Caribbean-National.png"
alt="Lepanthes population" />
<div class="figcaption">Lepanthes population</div>
</div>
<hr />
</div>
<div id="articulo-para-guiar-su-aprendizaje" class="section level2">
<h2>Articulo para guiar su aprendizaje</h2>
<p><a
href="PDF/When%20stable-stage%20equilibrium%20is%20unlikely-%20integrating%20transient%20population%20dynsmics.pdf">Tremblay,
Raventos Ackerman</a>. Habrá un quiz de comprobación de lectura al
principio de la clase.</p>
<hr />
</div>
<div id="lepanthes-rubripetala-population-3" class="section level1">
<h1><em>Lepanthes rubripetala</em> population #3</h1>
<div id="how-to-construct-a-matrix-in-r" class="section level3">
<h3>How to construct a matrix in R</h3>
<p>En general lo que uno hace es separar la matriz de transciones (matU)
de la matriz de fecundidad (matF). Eso es para tener claro los procesos
que ocurren en la población. Sumando ambas matriz
<strong>matU</strong>+<strong>matF</strong> = <strong>matA</strong>
tenemos la matriz para evaluar la dinamica poblacional de esa población.
Nota que eso es la nueva terminología que van a encontrar en la
literatura reciente, <strong>matU</strong> y <strong>matF</strong> y
<strong>matA</strong></p>
<pre class="r"><code>library(Rage)
matU=matrix(c(
0.43,   0,      0.00,   0.00, 
0.38,     0.84,   0.00,   0.00, 
0,      0.00,     0.51,   0.15,
0,      0.14,   0.43,   0.84),
byrow=4, ncol=4)

matU</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.00
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.14 0.43 0.84</code></pre>
<pre class="r"><code>matF=matrix(c(
0,    0,      0,    0.14,
0,    0,      0,      0, 
0,    0,      0,      0,    
0,    0,    0,    0
), byrow=4, ncol=4)

matF</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0 0.14
## [2,]    0    0    0 0.00
## [3,]    0    0    0 0.00
## [4,]    0    0    0 0.00</code></pre>
<pre class="r"><code>TF=matU+matF
TF</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.14
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.14 0.43 0.84</code></pre>
<pre class="r"><code>colnames(TF) &lt;- c(&quot;plantulas&quot;, &quot;juveniles&quot;, &quot;A no reprod&quot;, &quot;A reprod&quot;)
rownames(TF) &lt;- colnames(TF)
TF</code></pre>
<pre><code>##             plantulas juveniles A no reprod A reprod
## plantulas        0.43      0.00        0.00     0.14
## juveniles        0.38      0.84        0.00     0.00
## A no reprod      0.00      0.00        0.51     0.15
## A reprod         0.00      0.14        0.43     0.84</code></pre>
<pre class="r"><code>orchid_names= c(&quot;1_plantulas&quot;, &quot;2_juveniles&quot;, &quot;3_adulto no reproductivos&quot;, &quot;4_adultos reproductivos&quot;)



orchid_names_2= c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;)
#stages &lt;- c(TF_TF) 
plot_life_cycle(TF) </code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-f81d56f1030c9f4f7501" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f81d56f1030c9f4f7501">{"x":{"diagram":"\ndigraph {\n  {\n    graph[overlap=false];\n    rank=same;\n    node [shape= egg , fontsize= 12 ]; \"plantulas\" -> \"juveniles\" -> \"A no reprod\" -> \"A reprod\" [style=invis] \n  } ordering=out\n  x [style=invis]\n  x -> { \"plantulas\" -> \"juveniles\" -> \"A no reprod\" -> \"A reprod\" [style=invis] } [style=invis] \"plantulas\" -> \"plantulas\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"plantulas\" -> \"juveniles\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.38\"]\n\"juveniles\" -> \"juveniles\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n\"juveniles\" -> \"A reprod\"[minlen=6,fontsize=10,color=grey,xlabel=\" 0.14\"]\n\"A no reprod\" -> \"A no reprod\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.51\"]\n\"A no reprod\" -> \"A reprod\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"A reprod\" -> \"plantulas\"[minlen=-9,fontsize=10,color=grey,xlabel=\" 0.14\"]\n\"A reprod\" -> \"A no reprod\"[minlen=-3,fontsize=10,color=grey,xlabel=\" 0.15\"]\n\"A reprod\" -> \"A reprod\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n labelloc=\"t\";\n  label=\"  \"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>#plot_life_cycle(TF, stages = orchid_names_2)</code></pre>
<hr />
<p>Here is the theoretical life cycle of the species</p>
<div class="float">
<img src="figures/Fig_theoretical_Life_cycle.png"
alt="Theoretical life cycle" />
<div class="figcaption">Theoretical life cycle</div>
</div>
<hr />
<hr />
</div>
<div id="crecimiento-poblacional-intrinsico" class="section level3">
<h3>Crecimiento poblacional intrinsico</h3>
<p>La definición de <strong>crecimiento poblacional asimptotico”: Si
nada más cambia, la población eventualmente alcanza la
</strong>distribución de etapa estable** y la <strong>razón de cambio de
la población</strong> se acerca a una tasa constante (la tasa de
crecimiento demográfico asintótica).</p>
<p>lambda = 1: la población es estable</p>
<p>lambda &lt; 1: la población reduce en tamaño</p>
<p>lambda &gt; 1: la población aumenta</p>
<p>This is a measure of the asymptotic population growth rate of the
species</p>
<pre class="r"><code>TF</code></pre>
<pre><code>##             plantulas juveniles A no reprod A reprod
## plantulas        0.43      0.00        0.00     0.14
## juveniles        0.38      0.84        0.00     0.00
## A no reprod      0.00      0.00        0.51     0.15
## A reprod         0.00      0.14        0.43     0.84</code></pre>
<pre class="r"><code>library(popbio)
lambda(TF) # crecimiento de 3% </code></pre>
<pre><code>## [1] 1.029629</code></pre>
</div>
<div id="ejercicio-1" class="section level3">
<h3>Ejercicio 1</h3>
<p>Cambie el valor de supervivencia de los adultos reprodutivos a la
mitad y evalue el crecimiento de la población.</p>
<pre class="r"><code>library(Rage)
matU1=matrix(c(
0.43,   0,    0,    0.00,
0.38,   0.84,   0,    0, 
0,      0,    0.51, 0.15,   
0,      0.14, 1.43, 0.44
), byrow=4, ncol=4)

matU1</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.00
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.14 1.43 0.44</code></pre>
<pre class="r"><code>matF1=matrix(c(
0,    0,      0,    0.14,
0,    0,      0,      0, 
0,    0,      0,      0,    
0,    0,    0,    0
), byrow=4, ncol=4)

matF1</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0 0.14
## [2,]    0    0    0 0.00
## [3,]    0    0    0 0.00
## [4,]    0    0    0 0.00</code></pre>
<pre class="r"><code>TF1=matU1+matF1
TF1</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.14
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.14 1.43 0.44</code></pre>
<pre class="r"><code>lambda(TF1)</code></pre>
<pre><code>## [1] 0.9846844</code></pre>
</div>
<div id="ejercicio-2" class="section level3">
<h3>Ejercicio 2</h3>
<p>Cambie el de reproducción a 100% de la matriz original.</p>
<pre class="r"><code>library(Rage)
matU2=matrix(c(
0.43,   0,    0,    0.00,
0.38,   0.84,   0,    0, 
0,      0,    0.51, 0.15,   
0,      0.14, 0.43, 0.84
), byrow=4, ncol=4)

matU2</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.00
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.14 0.43 0.84</code></pre>
<pre class="r"><code>matF2=matrix(c(
0,    0,      0,    3.6,
0,    0,      0,      0, 
0,    0,      0,      0,    
0,    0,    0,    0
), byrow=4, ncol=4)

matF2</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0  3.6
## [2,]    0    0    0  0.0
## [3,]    0    0    0  0.0
## [4,]    0    0    0  0.0</code></pre>
<pre class="r"><code>TF2=matU2+matF2
lambda(TF2)</code></pre>
<pre><code>## [1] 1.339431</code></pre>
<pre class="r"><code>x=c(3,4,8,3,3,5,2,7,2,4,2,2,3,3,3)
sum(x)</code></pre>
<pre><code>## [1] 54</code></pre>
<pre class="r"><code>mean(x)</code></pre>
<pre><code>## [1] 3.6</code></pre>
<hr />
</div>
<div
id="dos-posible-problemas-se-tiene-que-considerar-antes-de-hacer-los-analisis"
class="section level2">
<h2>Dos posible problemas se tiene que considerar antes de hacer los
analisis</h2>
<ul>
<li><strong>Ergodicity</strong>
<ul>
<li>la condición que irrelevante cual es el la etapa inicial, el
crecimiento poblacional asimptotico sera igual</li>
</ul></li>
<li><strong>Irreducibility</strong>
<ul>
<li>la condición que las transiciones de todas las etapas a otra son
posibles.</li>
</ul></li>
</ul>
<p>Recuerda la definición de <strong>crecimiento poblacional
asimptotico”: Si nada más cambia, la población eventualmente alcanza la
</strong>distribución de etapa estable** y la <strong>razón de cambio de
la población</strong> se acerca a una tasa constante (la tasa de
crecimiento demográfico asintótica).</p>
<p>Si no cumple con esas condiciones los analisis pueden ser severamente
impactado. (Stott et al., 2010a).</p>
<p>Pueden probar esas dos condiciones usando las funciones en
“popdemo”.</p>
<pre class="r"><code>library(popdemo)
isErgodic(TF, digits=10, return.eigvec=FALSE)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>isIrreducible(TF)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>plot_life_cycle(TF)</code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-b28bdc049c35513929a8" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b28bdc049c35513929a8">{"x":{"diagram":"\ndigraph {\n  {\n    graph[overlap=false];\n    rank=same;\n    node [shape= egg , fontsize= 12 ]; \"plantulas\" -> \"juveniles\" -> \"A no reprod\" -> \"A reprod\" [style=invis] \n  } ordering=out\n  x [style=invis]\n  x -> { \"plantulas\" -> \"juveniles\" -> \"A no reprod\" -> \"A reprod\" [style=invis] } [style=invis] \"plantulas\" -> \"plantulas\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"plantulas\" -> \"juveniles\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.38\"]\n\"juveniles\" -> \"juveniles\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n\"juveniles\" -> \"A reprod\"[minlen=6,fontsize=10,color=grey,xlabel=\" 0.14\"]\n\"A no reprod\" -> \"A no reprod\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.51\"]\n\"A no reprod\" -> \"A reprod\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"A reprod\" -> \"plantulas\"[minlen=-9,fontsize=10,color=grey,xlabel=\" 0.14\"]\n\"A reprod\" -> \"A no reprod\"[minlen=-3,fontsize=10,color=grey,xlabel=\" 0.15\"]\n\"A reprod\" -> \"A reprod\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n labelloc=\"t\";\n  label=\"  \"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>lambda(TF)</p>
<hr />
<div id="ergodica" class="section level4">
<h4>Ergodica</h4>
<p>Evaluamos una población que no es <em>Ergodica</em></p>
<ul>
<li>Cualquiera que sea la estructura de la etapa inicial que se utilice
en la proyección de población, siempre exhibirá la misma tasa de
crecimiento asintótica estable.</li>
</ul>
<pre class="r"><code> library(Rage)
matU4=matrix(c(
0.43,   0,      0,     0.00,
0.38,     0.84,     0,     0, 
0.00,   0,      0.51,    0.15,  
0,      0.0,    0.43,  0.84
), byrow=4, ncol=4)

matU4  # ¿Cual es el problema con esa matriz?</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.00
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.00 0.43 0.84</code></pre>
<pre class="r"><code>matF4=matrix(c(
0,    0,      0,    0.28,
0,    0,      0,      0, 
0,    0,      0,      0,    
0,    0,    0,    0
), byrow=4, ncol=4)

matF4</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0 0.28
## [2,]    0    0    0 0.00
## [3,]    0    0    0 0.00
## [4,]    0    0    0 0.00</code></pre>
<pre class="r"><code>TF4=matU4+matF4

isErgodic(TF4)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>isIrreducible(TF4)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>plot_life_cycle(TF4)</code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-4b4f498b37ebe42c07e1" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4b4f498b37ebe42c07e1">{"x":{"diagram":"\ndigraph {\n  {\n    graph[overlap=false];\n    rank=same;\n    node [shape= egg , fontsize= 12 ]; \"1\" -> \"2\" -> \"3\" -> \"4\" [style=invis] \n  } ordering=out\n  x [style=invis]\n  x -> { \"1\" -> \"2\" -> \"3\" -> \"4\" [style=invis] } [style=invis] \"1\" -> \"1\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"1\" -> \"2\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.38\"]\n\"2\" -> \"2\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n\"3\" -> \"3\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.51\"]\n\"3\" -> \"4\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"4\" -> \"1\"[minlen=-9,fontsize=10,color=grey,xlabel=\" 0.28\"]\n\"4\" -> \"3\"[minlen=-3,fontsize=10,color=grey,xlabel=\" 0.15\"]\n\"4\" -> \"4\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n labelloc=\"t\";\n  label=\"  \"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<hr />
</div>
<div id="irreducible" class="section level4">
<h4>Irreducible</h4>
<p>Evaluamos una población que no es <em>Ergodica</em></p>
<p>El gráfico del ciclo de vida asociado contiene las tasas de
transición necesarias para facilitar los caminos desde todas las etapas
a todas las demás etapas</p>
<pre class="r"><code> library(Rage)
matU4=matrix(c(
0.43,   0,    0,    0.00,
0.38,   0.84,   0,    0, 
0,      0,    0.51, 0.15,   
0,      0.0, 0.43, 0.84
), byrow=4, ncol=4)

matU4  # ¿Cual es el problema con esa matriz?</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.43 0.00 0.00 0.00
## [2,] 0.38 0.84 0.00 0.00
## [3,] 0.00 0.00 0.51 0.15
## [4,] 0.00 0.00 0.43 0.84</code></pre>
<pre class="r"><code>matF4=matrix(c(
0,    0,      0,    0.28,
0,    0,      0,      0, 
0,    0,      0,      0,    
0,    0,    0,    0
), byrow=4, ncol=4)

matF4</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0 0.28
## [2,]    0    0    0 0.00
## [3,]    0    0    0 0.00
## [4,]    0    0    0 0.00</code></pre>
<pre class="r"><code>TF4=matU4+matF4

isIrreducible(TF4)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>plot_life_cycle(TF4)</code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-7cff03958c6c66c4d1af" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7cff03958c6c66c4d1af">{"x":{"diagram":"\ndigraph {\n  {\n    graph[overlap=false];\n    rank=same;\n    node [shape= egg , fontsize= 12 ]; \"1\" -> \"2\" -> \"3\" -> \"4\" [style=invis] \n  } ordering=out\n  x [style=invis]\n  x -> { \"1\" -> \"2\" -> \"3\" -> \"4\" [style=invis] } [style=invis] \"1\" -> \"1\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"1\" -> \"2\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.38\"]\n\"2\" -> \"2\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n\"3\" -> \"3\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.51\"]\n\"3\" -> \"4\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.43\"]\n\"4\" -> \"1\"[minlen=-9,fontsize=10,color=grey,xlabel=\" 0.28\"]\n\"4\" -> \"3\"[minlen=-3,fontsize=10,color=grey,xlabel=\" 0.15\"]\n\"4\" -> \"4\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.84\"]\n labelloc=\"t\";\n  label=\"  \"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="float">
<img src="figures/mee3_32_f1.gif" alt="Irreducible Matrix" />
<div class="figcaption">Irreducible Matrix</div>
</div>
<hr />
</div>
</div>
<div id="realidad-de-la-recopilación-de-datos" class="section level2">
<h2>Realidad de la recopilación de datos</h2>
<p>Sin embargo, los datos de la siguiente matriz son limitados porque la
colonización de semillas no se puede detectar en el campo con facilidad,
porque las semillas son demasiado pequeñas y no existe una técnica
rápida en el campo para detectar los hongos simbióticos y la
colonización de los hongos entrando en la semilla.</p>
<div class="float">
<img src="figures/orchid-mycorrhiza.jpg"
alt="Orchid with Mycorrhiza: From 21st Century Guidebook to Fungi, SECOND EDITION, by David Moore, Geoffrey D. Robson and Anthony P. J. Trinci" />
<div class="figcaption">Orchid with Mycorrhiza: From 21st Century
Guidebook to Fungi, SECOND EDITION, by David Moore, Geoffrey D. Robson
and Anthony P. J. Trinci</div>
</div>
<hr />
<p>Esta matriz se basa en el tamaños o carateristicas observable en el
campo, con una fecundidad media. Las clases de tamaño son las
siguientes:</p>
<ul>
<li>1: Plántula</li>
<li>2: Juveniles</li>
<li>3: A0: adultos no reproductivos</li>
<li>4: A+: adultos reproductivos</li>
</ul>
<div id="section" class="section level75">
<p class="heading"></p>
<p>#FIGURE 1: POPULATION PROJECTION #</p>
<p>#This figure is designed to be 3.5” by 3.5” #(Check size of plot
window using ‘par(din)’). # # #Set margins: par(mar=c(5,4,1,1))</p>
<p>#Create a population vector. This one is biased towards adults.</p>
<pre class="r"><code>n0 &lt;- c(10, 10, 10, 10)</code></pre>
</div>
</div>
<div id="now-project-the-population-for-x-years-in-the-future."
class="section level2">
<h2>Now project the population for x years in the future.</h2>
<p>Project the orchid PPM and population vector. In this case, we are
projecting for 24 time intervals. The orchid interval is one month, so
this projection is for 2 years. We use the function ‘project’.</p>
<pre class="r"><code>pr1 &lt;- project(TF, vector=n0, time=24)

#Plot the projection. This uses an S3 plotting
#method for projections. For info, see &#39;?plot.projection&#39;.  
plot(pr1)</code></pre>
<p><img src="Lepanthes_rubripetala_4_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="primitive-matrix" class="section level2">
<h2>Primitive Matrix</h2>
<p>For a primitive matrix (see below), the long-term growth rate is the
real part of the first dominant eigenvalue of the PPM.</p>
<pre class="r"><code>eigs &lt;- eigen(TF)
eigs # los diferentes eigenvalue de la matrix. El que responde al crecimiento intrinsico de la población es la parte mayor real.    </code></pre>
<pre><code>## eigen() decomposition
## $values
## [1] 1.0296288+0.00000000i 0.7709252+0.00000000i 0.4097230+0.05003503i
## [4] 0.4097230-0.05003503i
## 
## $vectors
##              [,1]          [,2]                    [,3]                    [,4]
## [1,] 0.2004457+0i -0.1598129+0i  0.67656050+0.00000000i  0.67656050+0.00000000i
## [2,] 0.4016762+0i  0.8791759+0i -0.58953389-0.06855432i -0.58953389+0.06855432i
## [3,] 0.2478274+0i -0.2237269+0i  0.26185876-0.23103598i  0.26185876+0.23103598i
## [4,] 0.8585216+0i -0.3891732+0i -0.09799012+0.24179804i -0.09799012-0.24179804i</code></pre>
<pre class="r"><code>lambdamax &lt;- Re(eigs$values[1]) # esta función seleciona para el primer valor
lambdamax</code></pre>
<pre><code>## [1] 1.029629</code></pre>
<pre class="r"><code># Es más facil utilzar la siguiente función en el paquete popdemo

truelambda(TF) # Con el paquete popdemo</code></pre>
<pre><code>##          [,1]     [,2]
## [1,] 1.029629 1.029629
## [2,] 1.029629 1.029629
## [3,] 1.029629 1.029629
## [4,] 1.029629 1.029629</code></pre>
<pre class="r"><code>popbio::lambda(TF) # con el paquete popbio</code></pre>
<pre><code>## [1] 1.029629</code></pre>
<div id="distribución-estable-de-la-población-w" class="section level3">
<h3>Distribución estable de la población, <strong>w</strong></h3>
<p>Stable Stage distribution</p>
<p>The stable demographic structure of the population is equal to the
dominant right eigenvector, which is the absolute value of the real part
of the first eigenvector.</p>
<p>This is the expected proportional distribution among the different
stages <strong>IF</strong> the population attains a stable
structure.</p>
<p>Compara la porporción que hay por etapas al principio de la
investigación.</p>
<p>n0 &lt;- c(10, 10, 10, 10)</p>
<pre class="r"><code>library(popbio)
w &lt;- stable.stage(TF)
w</code></pre>
<pre><code>##   plantulas   juveniles A no reprod    A reprod 
##   0.1173246   0.2351086   0.1450580   0.5025088</code></pre>
<pre class="r"><code>barplot(w, col=&quot;green&quot;, ylim=c(0,1), las=1, main=&quot;Lepanthes rubripetala&quot;,
     ylab=&quot;La proporción Etapa de Vida&quot;, xlab=&quot;Etapas de vida&quot;)</code></pre>
<p><img src="Lepanthes_rubripetala_4_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Note that the package popbio provides functions ‘lambda’ and
‘stable.stage’ that will provide these also.</p>
</div>
<div id="elasticidad" class="section level3">
<h3>Elasticidad</h3>
<p>• Elasticity: the proportional change in population growth rate
resulting from an equivalent proportional change in a specific vital
rate.</p>
<p>• Elasticidad: el cambio proporcional en la tasa de crecimiento de la
población resultante de un cambio proporcional equivalente en una tasa
vital específica.</p>
<pre class="r"><code>elas(TF)</code></pre>
<pre><code>##              plantulas  juveniles A no reprod   A reprod
## plantulas   0.02693792 0.00000000  0.00000000 0.03756455
## juveniles   0.03756455 0.16639992  0.00000000 0.00000000
## A no reprod 0.00000000 0.00000000  0.06986646 0.07118554
## A reprod    0.00000000 0.03756455  0.07118554 0.48173098</code></pre>
<p>Excercise. <em>Caretta caretta</em></p>
<p>Use data from COMADRE: Crowder LB; Crouse DT; Heppell SS; Martin
Reference Type: Journal Article DOI/ISBN: 10.2307/1941948 Journal Name:
Ecol Appl Title: Year: 1994 Volume: Pages:</p>
<p>Caretta caretta:</p>
<div class="float">
<img src="figures/Caretta_caretta.png" alt="Caretta caretta matrix" />
<div class="figcaption">Caretta caretta matrix</div>
</div>
<pre class="r"><code>#remotes::install_github(&quot;jonesor/Rage&quot;) # eso es para instalar el programa directo de github</code></pre>
<p>Las matrices</p>
<pre class="r"><code>matUCc=matrix(c(
0,      0,           0,     0,     0,
0.675,  0.703,     0,       0,     0,
0,      0.047,     0.657,  0,    0, 
0   ,     0,           0.019,   0.682, 0,
0,      0,         0,     0.061, 0.8091
), byrow=5, ncol=5)



matFCc=matrix(c(            
0,  0,  0,  4.665, 61.896,
0,  0,  0,  0, 0,
0,  0,  0,  0, 0,
0,  0,  0,  0, 0,
0,  0,  0,  0, 0
), byrow=5, ncol=5)

matACc=matUCc+matFCc

matACc</code></pre>
<pre><code>##       [,1]  [,2]  [,3]  [,4]    [,5]
## [1,] 0.000 0.000 0.000 4.665 61.8960
## [2,] 0.675 0.703 0.000 0.000  0.0000
## [3,] 0.000 0.047 0.657 0.000  0.0000
## [4,] 0.000 0.000 0.019 0.682  0.0000
## [5,] 0.000 0.000 0.000 0.061  0.8091</code></pre>
<pre class="r"><code>plot_life_cycle(matACc)</code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-67c388927faf32f29164" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-67c388927faf32f29164">{"x":{"diagram":"\ndigraph {\n  {\n    graph[overlap=false];\n    rank=same;\n    node [shape= egg , fontsize= 12 ]; \"1\" -> \"2\" -> \"3\" -> \"4\" -> \"5\" [style=invis] \n  } ordering=out\n  x [style=invis]\n  x -> { \"1\" -> \"2\" -> \"3\" -> \"4\" -> \"5\" [style=invis] } [style=invis] \"1\" -> \"2\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.675\"]\n\"2\" -> \"2\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.703\"]\n\"2\" -> \"3\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.047\"]\n\"3\" -> \"3\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.657\"]\n\"3\" -> \"4\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.019\"]\n\"4\" -> \"1\"[minlen=-9,fontsize=10,color=grey,xlabel=\" 4.665\"]\n\"4\" -> \"4\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.682\"]\n\"4\" -> \"5\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.061\"]\n\"5\" -> \"1\"[minlen=-12,fontsize=10,color=grey,xlabel=\" 61.896\"]\n\"5\" -> \"5\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.809\"]\n labelloc=\"t\";\n  label=\"  \"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>colnames(matACc) &lt;- c(&quot;Huevos&quot;, &quot;small_juv(1-7yrs)&quot;, &quot;Large_juv(8-15)&quot;, &quot;Subadults(16-21)&quot;, &quot;Adults(22+)&quot;)
rownames(matACc) &lt;- colnames(matACc)


library(Rage)
plot_life_cycle(matACc) # life cycle with names</code></pre>
<div class="grViz html-widget html-fill-item" id="htmlwidget-58606d47b924ed93d1b9" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-58606d47b924ed93d1b9">{"x":{"diagram":"\ndigraph {\n  {\n    graph[overlap=false];\n    rank=same;\n    node [shape= egg , fontsize= 12 ]; \"Huevos\" -> \"small_juv(1-7yrs)\" -> \"Large_juv(8-15)\" -> \"Subadults(16-21)\" -> \"Adults(22+)\" [style=invis] \n  } ordering=out\n  x [style=invis]\n  x -> { \"Huevos\" -> \"small_juv(1-7yrs)\" -> \"Large_juv(8-15)\" -> \"Subadults(16-21)\" -> \"Adults(22+)\" [style=invis] } [style=invis] \"Huevos\" -> \"small_juv(1-7yrs)\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.675\"]\n\"small_juv(1-7yrs)\" -> \"small_juv(1-7yrs)\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.703\"]\n\"small_juv(1-7yrs)\" -> \"Large_juv(8-15)\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.047\"]\n\"Large_juv(8-15)\" -> \"Large_juv(8-15)\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.657\"]\n\"Large_juv(8-15)\" -> \"Subadults(16-21)\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.019\"]\n\"Subadults(16-21)\" -> \"Huevos\"[minlen=-9,fontsize=10,color=grey,xlabel=\" 4.665\"]\n\"Subadults(16-21)\" -> \"Subadults(16-21)\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.682\"]\n\"Subadults(16-21)\" -> \"Adults(22+)\"[minlen=3,fontsize=10,color=grey,xlabel=\" 0.061\"]\n\"Adults(22+)\" -> \"Huevos\"[minlen=-12,fontsize=10,color=grey,xlabel=\" 61.896\"]\n\"Adults(22+)\" -> \"Adults(22+)\"[minlen=0,fontsize=10,color=grey,xlabel=\" 0.809\"]\n labelloc=\"t\";\n  label=\"  \"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>truelambda(matACc)</code></pre>
<pre><code>##           [,1]      [,2]
## [1,] 0.9515816 0.9515817
## [2,] 0.9515816 0.9515817
## [3,] 0.9515816 0.9515818
## [4,] 0.9515817 0.9515818
## [5,] 0.9515817 0.9515819</code></pre>
<pre class="r"><code>lambda(matACc)</code></pre>
<pre><code>## [1] 0.9515817</code></pre>
<p>Plot turtle growth</p>
<pre class="r"><code>nCc &lt;- c(10, 10, 10, 10, 1000)
pr1 &lt;- project(matACc, vector=nCc, time=240)

#Plot the projection. This uses an S3 plotting
#method for projections. For info, see &#39;?plot.projection&#39;.  
plot(pr1)</code></pre>
<p><img src="Lepanthes_rubripetala_4_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
<div id="elasticities" class="section level2">
<h2>Elasticities</h2>
<p>Perturbation analysis is an intuitively appealing way to answer
questions about the relative importance of variation in parameters in
the matrix. … Elasticity analysis estimates the effect of a proportional
change in the vital rates on population growth rate λ (= er, where r is
the per capita rate of population increase)1, 2.</p>
<pre class="r"><code>matACc # the matrix matU</code></pre>
<pre><code>##                   Huevos small_juv(1-7yrs) Large_juv(8-15) Subadults(16-21)
## Huevos             0.000             0.000           0.000            4.665
## small_juv(1-7yrs)  0.675             0.703           0.000            0.000
## Large_juv(8-15)    0.000             0.047           0.657            0.000
## Subadults(16-21)   0.000             0.000           0.019            0.682
## Adults(22+)        0.000             0.000           0.000            0.061
##                   Adults(22+)
## Huevos                61.8960
## small_juv(1-7yrs)      0.0000
## Large_juv(8-15)        0.0000
## Subadults(16-21)       0.0000
## Adults(22+)            0.8091</code></pre>
<pre class="r"><code>round(elas(matACc),digit=4) # elas=elasticities, en el paquete &quot;popdemo&quot;</code></pre>
<pre><code>##                   Huevos small_juv(1-7yrs) Large_juv(8-15) Subadults(16-21)
## Huevos            0.0000            0.0000          0.0000           0.0087
## small_juv(1-7yrs) 0.0579            0.1638          0.0000           0.0000
## Large_juv(8-15)   0.0000            0.0579          0.1292           0.0000
## Subadults(16-21)  0.0000            0.0000          0.0579           0.1465
## Adults(22+)       0.0000            0.0000          0.0000           0.0492
##                   Adults(22+)
## Huevos                 0.0492
## small_juv(1-7yrs)      0.0000
## Large_juv(8-15)        0.0000
## Subadults(16-21)       0.0000
## Adults(22+)            0.2796</code></pre>
</div>
<div id="stable-stage-distribution." class="section level2">
<h2>Stable Stage distribution.</h2>
<p>La proporción de individuos por etapa cuando la población llega a su
estabilidad/madura</p>
<pre class="r"><code>stable.stage(matACc) # en el paquete popdemo</code></pre>
<pre><code>##            Huevos small_juv(1-7yrs)   Large_juv(8-15)  Subadults(16-21) 
##       0.238535412       0.647720163       0.103342617       0.007283541 
##       Adults(22+) 
##       0.003118266</code></pre>
</div>
</div>
<div id="damping-ratio" class="section level1">
<h1>Damping Ratio</h1>
<p>Es un indice de medida de tiempo que toma la población a llegar a su
etapas estable</p>
<p><span
class="math display">\[\rho=\frac{\lambda_1}{|\lambda_2|}\]</span></p>
<p>The damping ratio (ρ) is a measure of how fast a population will
converge to the stable stage distribution and is defined as the dominant
eigenvalue (λ1) divided by the absolute value of the largest subdominant
eigenvalue (λ2) (Caswell 1989).</p>
<p>Thus <strong>small damping ratio</strong> suggest that populations
will take a <strong>long time</strong> to attain stable stage
distribution, while <strong>large damping ratio</strong>, the stable
stage distribution will be attain within a <strong>few</strong> time
periods.</p>
<pre class="r"><code>eigen(TF)</code></pre>
<pre><code>## eigen() decomposition
## $values
## [1] 1.0296288+0.00000000i 0.7709252+0.00000000i 0.4097230+0.05003503i
## [4] 0.4097230-0.05003503i
## 
## $vectors
##              [,1]          [,2]                    [,3]                    [,4]
## [1,] 0.2004457+0i -0.1598129+0i  0.67656050+0.00000000i  0.67656050+0.00000000i
## [2,] 0.4016762+0i  0.8791759+0i -0.58953389-0.06855432i -0.58953389+0.06855432i
## [3,] 0.2478274+0i -0.2237269+0i  0.26185876-0.23103598i  0.26185876+0.23103598i
## [4,] 0.8585216+0i -0.3891732+0i -0.09799012+0.24179804i -0.09799012-0.24179804i</code></pre>
<pre class="r"><code># Calcular a mano el damping.ratio
1.0296/abs(0.7709) # Calcular a mano</code></pre>
<pre><code>## [1] 1.335582</code></pre>
<pre class="r"><code>dr(TF, return.time=TRUE, x=10)</code></pre>
<pre><code>## $dr
## [1] 1.335576
## 
## $t
## [1] 7.957447</code></pre>
<pre class="r"><code>eigen(matACc)</code></pre>
<pre><code>## eigen() decomposition
## $values
## [1] 9.515817e-01+0.0000000i 7.116992e-01+0.2231612i 7.116992e-01-0.2231612i
## [4] 4.761170e-01+0.0000000i 2.880582e-06+0.0000000i
## 
## $vectors
##                [,1]                       [,2]                       [,3]
## [1,] 0.341748635+0i -0.0120093429-0.308076711i -0.0120093429+0.308076711i
## [2,] 0.927985828+0i -0.9318454510+0.000000000i -0.9318454510+0.000000000i
## [3,] 0.148058513+0i -0.0453781577+0.185133353i -0.0453781577-0.185133353i
## [4,] 0.010435098+0i  0.0149827612+0.005857473i  0.0149827612-0.005857473i
## [5,] 0.004467527+0i -0.0001565665-0.004027127i -0.0001565665+0.004027127i
##                 [,4]            [,5]
## [1,] -0.309283738+0i -0.720439943+0i
## [2,]  0.920150536+0i  0.691748157+0i
## [3,] -0.239088653+0i -0.049486006+0i
## [4,]  0.022064397+0i  0.001378648+0i
## [5,] -0.004042033+0i -0.000103940+0i</code></pre>
<pre class="r"><code>matACc</code></pre>
<pre><code>##                   Huevos small_juv(1-7yrs) Large_juv(8-15) Subadults(16-21)
## Huevos             0.000             0.000           0.000            4.665
## small_juv(1-7yrs)  0.675             0.703           0.000            0.000
## Large_juv(8-15)    0.000             0.047           0.657            0.000
## Subadults(16-21)   0.000             0.000           0.019            0.682
## Adults(22+)        0.000             0.000           0.000            0.061
##                   Adults(22+)
## Huevos                61.8960
## small_juv(1-7yrs)      0.0000
## Large_juv(8-15)        0.0000
## Subadults(16-21)       0.0000
## Adults(22+)            0.8091</code></pre>
<pre class="r"><code>0.95158/abs(0.711699)</code></pre>
<pre><code>## [1] 1.337054</code></pre>
<pre class="r"><code>dr(matACc)</code></pre>
<pre><code>## [1] 1.275807</code></pre>
<pre class="r"><code>dr(matACc, return.time=TRUE, x=10) # damping ratio</code></pre>
<pre><code>## $dr
## [1] 1.275807
## 
## $t
## [1] 9.453131</code></pre>
<div id="convergence-time" class="section level2">
<h2>Convergence Time</h2>
<p>Convergence Time is the expected time for a population at attain
stable stage distribution. Calculate the time to convergence of a
population matrix projection model from the model projection. convt(A,
vector = “n”, accuracy = 0.01, iterations = 1e+05)</p>
<pre class="r"><code># convt, en popdemo
n=c(1000,0,0,0, 0)
convt(matACc, accuracy=1e-3, vector=n) # Convergence time to Stable Stage Distribution from an invasive species starting with smallest size</code></pre>
<pre><code>## [1] 27</code></pre>
<pre class="r"><code>n1=c(238,648,103,7, 3)
convt(matACc, accuracy=1e-3, vector=n1) # Convergence time to Stable Stage Distribution when close to Stable Stage</code></pre>
<pre><code>## [1] 6</code></pre>
<pre class="r"><code>n2=c(0,0,0,0,1000)
convt(matACc, accuracy=1e-3, vector=n2) # Convergence time to Stable Stage Distribution when starting with an invasive species of adults</code></pre>
<pre><code>## [1] 24</code></pre>
<hr />
<div id="section-1" class="section level75">
<p class="heading"></p>
</div>
</div>
<div id="transient-dynamics" class="section level2">
<h2>TRANSIENT DYNAMICS</h2>
<hr />
</div>
</div>
<div id="section-2" class="section level1">
<h1></h1>
<p>Fig. 2a: Population-specific transient dynamics # This figure is
designed to be 3.5” by 3.5” (Check size of plot window using
‘par(din)’).</p>
<p>Set margins:</p>
<pre class="r"><code>par(mar=c(10,4,1,1))</code></pre>
<p>Create 2 population vectors. One is adult- biased, and it amplifies.
One is juvenile- biased and it attenuates.</p>
<pre class="r"><code>n0.att &lt;- c(1000,1,1,1) # La población es sesgada a una estructura de etapas pequeñas

n0.amp &lt;- c(1,1,1,1000) # la población es sesgada a una estructura de etapas grandes</code></pre>
<p>Project these vectors using the project function. We are
standardising the matrix using ‘standard.A=T’ to remove effects of
asymptotic dynamics. This means that the projection has a long-term
growth rate of unity, i.e. it does not grow or decline in the long-term.
We also standardise the population vector to sum to 1 using
‘standard.vec=T’. These standardisations make it easier (and fairer) to
compare between models with different population sizes, and different
long-term growth rates.</p>
<pre class="r"><code>pr2.1amp &lt;- project(TF, vector=n0.amp, time=50, 
                 standard.A=T, standard.vec=T)
pr2.2att &lt;- project(TF, vector=n0.att, time=50, 
                 standard.A=T, standard.vec=T)</code></pre>
<p>Plot the amplification projection and label it</p>
<pre class="r"><code>plot(pr2.2att, ylim=c(0.4,1.0), log=&quot;y&quot;, cex.axis=0.8)
text(30, pr2.2att[10], &quot;attenuation&quot;, 
     adj=c(1,-0.5), cex=0.8)</code></pre>
<p><img src="Lepanthes_rubripetala_4_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>plot(pr2.1amp, ylim=c(0.4,1.2), log=&quot;y&quot;, cex.axis=0.8)
text(30, pr2.1amp[10], &quot;amplification&quot;, 
     adj=c(1,-.25), cex=0.8)</code></pre>
<p><img src="Lepanthes_rubripetala_4_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<pre class="r"><code>maxamp(TF )</code></pre>
<pre><code>## [1] 1.17506</code></pre>
<pre class="r"><code>reac(TF,bound = &quot;upper&quot;)</code></pre>
<pre><code>## [1] 1.097483</code></pre>
<pre class="r"><code>inertia(TF,bound = &quot;lower&quot;)</code></pre>
<pre><code>## [1] 0.5497777</code></pre>
<p>Calculate the transient dynamics of the amplification projection.</p>
<pre class="r"><code>reac &lt;- reac(TF, vector=n0.amp)
maxamp &lt;- maxamp(TF,  return.t=T)
upinertia &lt;- inertia(TF, vector=n0.amp)</code></pre>
<p>Add points on the projection for amplification and label them</p>
<pre class="r"><code>par(mar=c(10,4,1,1))
points(c(1,maxamp$t,31), c(reac,maxamp$maxamp,upinertia), 
       pch=3, col=&quot;red&quot;)
text(1, reac, expression(bar(P)[1]), 
     adj=c(-0.3,0.5), col=&quot;red&quot;, cex=0.8)
text(maxamp$t, maxamp$maxamp, expression(bar(P)[max]), 
     adj=c(0.1,-0.5), col=&quot;red&quot;, cex=0.8)
text(31, upinertia, expression(bar(P)[infinity]), 
     adj=c(0.1,-0.5), col=&quot;red&quot;, cex=0.8)

#Add in the second projection using the
#&#39;lines&#39; command and label it
lines(0:50, pr2.2)
text(52, pr2.2[51], &quot;attenuation&quot;, adj=c(1,1), cex=0.8)</code></pre>
<p>Calculate the transient dynamics of the attenuation projection
firstep &lt;- firststepatt(TF, vector=n0.att) maxatt &lt;- maxatt(TF,
vector=n0.att, return.t=T) lowinertia &lt;- inertia(TF,
vector=n0.att)</p>
<p>firststepatt(TF, vector=n0.att) maxatt(TF, vector=n0.att, return.t=T)
inertia(TF, vector=n0.att)</p>
<p>Add points on the attenuation projection and label them
points(c(1,maxatt<span class="math inline">\(t,31),
c(firstep,maxatt\)</span>maxatt,lowinertia), pch=3, col=“red”) text(1,
firstep, expression(underline(P)[1]), adj=c(0,-0.6), col=“red”, cex=0.8)
text(maxatt<span class="math inline">\(t, maxatt\)</span>maxatt,
expression(underline(P)[min]), adj=c(0.1,1.5), col=“red”, cex=0.8)
text(31, lowinertia, expression(underline(P)[infinity]), adj=c(0.1,1.5),
col=“red”, cex=0.8)</p>
<p>Add in a dotted line at y=1 lines(c(0,50),c(1,1),lty=2)</p>
<hr />
<p>Fig. 2b: Transient bounds This figure is designed to be 3.5” by 3.5”
(Check size of plot window using ‘par(din)’).</p>
<p>Set margins: par(mar=c(5,4,1,1))</p>
<p>Transient bounds result from projections of the stage-biased dynamics
of the model. When using the function ‘project’, the stage-biased model
dynamics are projected automatically if no population vector is
specified. We can do this for the orchid, using a standardised matrix
like before: pr2 &lt;- project(TF, standard.A=TRUE, time=156)</p>
<p>Now we need to plot these population dynamics. The S3 method for
projections automatically plots all stage-biased projections: plot(pr2,
log=“y”, cex.axis=0.8, ylim=c(0.4,1.5))</p>
<p>Add in a dotted line at y=1 lines(c(0,156), c(1,1), lty=2)</p>
<p>Calculate the bounds on transient dynamics for the orchid. This is
also done automatically if no population vector is specified. reacb
&lt;- reactivity(TF) firstepb &lt;- firststepatt(TF) maxampb &lt;-
maxamp(TF, return.t=T) maxattb &lt;- maxatt(TF, return.t=T) upinertiab
&lt;- inertia(TF, bound=“upper”) lowinertiab &lt;- inertia(TF,
bound=“lower”)</p>
<p>reactivity(TF) firststepatt(TF) maxamp(TF, return.t=T) maxatt(TF,
return.t=T) inertia(TF, bound=“upper”) inertia(TF, bound=“lower”)</p>
<p>Add points on the projection and label them points(c(1,1,maxampb<span
class="math inline">\(t,maxattb\)</span>t,31,31),
c(reacb,firstepb,maxampb<span
class="math inline">\(maxamp,maxattb\)</span>maxatt,upinertiab,lowinertiab),
pch=3,col=“red”) text(1, reacb, expression(bar(rho)[1]),
adj=c(-0.5,0.5), col=“red”, cex=0.8) text(1, firstepb,
expression(underline(rho)[1]), adj=c(-0.5,1.5), col=“red”, cex=0.8)
text(maxampb<span class="math inline">\(t, maxampb\)</span>maxamp,
expression(bar(rho)[max]), adj=c(0.1,-0.5), col=“red”, cex=0.8)
text(maxattb<span class="math inline">\(t, maxattb\)</span>maxatt,
expression(underline(rho)[min]), adj=c(0.1,1.5), col=“red”, cex=0.8)
text(31, upinertiab, expression(bar(rho)[infinity]), adj=c(0.1,-0.5),
col=“red”, cex=0.8) text(31, lowinertiab,
expression(underline(rho)[infinity]), adj=c(0.1,1.5), col=“red”,
cex=0.8)</p>
<p>Amplification bounds result from the projection of a population with
100% stage x individuals. Attenuation bounds result from the projection
of a population with 100% stage 1 individuals.</p>
<div id="section-3" class="section level70">
<p class="heading"></p>
<p>FIGURE 3: TRANSFER FUNCTIONS</p>
<hr />
<p>Fig. 3a: Transfer function of asymptotic growth</p>
<p>This figure is designed to be 3.5” by 3.5” (Check size of plot window
using ‘par(din)’).</p>
<p>Set margins: par(mar=c(5,4,1,1))</p>
<p>Create a transfer function using ‘tfa’. The perturbation structure is
determined by two vectors d and e. The matrix d%*%t(e) gives the
structure, where nonzero elements in this matrix are the elements of the
PPM to be perturbed. The relative size of entries in this matrix are the
relative sizes of perturbation to those elements. In this case, we are
perturbing element [5,4]. We are going to look at the effect of
perturbing up to 0.25. The largest biologically reasonable perturbation
is about 0.12. tf1 &lt;- tfa(TF, d=c(1,0,0,0), e=c(0,0,1,0),
prange=seq(0,0.25,0.01))</p>
<p>Now we plot this using an S3 method for transfer functions (for
information see ‘?plot.tfa’). plot(tf1, cex.axis=0.8)</p>
<p>Now we’re going to add in the sensitivity tangent. This has an
intercept of lambda-max, and a slope of the sensitivity of the same
transfer function. Calculate lambda-max of the desert tortoise PPM:
lambda &lt;- Re(eigen(LaeliaZ1)$values[1])</p>
<p>Calculate the sensitivity using the function ‘tfsens’: sens1 &lt;-
tfsens(TF, d=c(0,0,0,1), e=c(0,0,1,0))</p>
<p>Now add in the line, specifying the correct intercept and slope:
abline(lambda, sens1, lty=2, col=“red”)</p>
<hr />
<p>Fig. 3b: Transfer function of population inertia</p>
<p>This figure is designed to be 3.5” by 3.5” (Check size of plot window
using ‘par(din)’).</p>
<p>Set margins: par(mar=c(5,4,1,1))</p>
<p>The process is very similar to above. We need to specify a PPM,
perturbation structure and perturbation range. For inertia we either
have to specify a population vector using the ‘vector’ argument, or the
bound to be calculated using the ‘bound’ argument. Create a population
vector: n0 &lt;- c(1,8,13,21)</p>
<p>tf1 &lt;- tfa(TF, d=c(0,0,0,1), e=c(0,0,1,0),
prange=seq(0,0.25,0.01))</p>
<p>Now calculate the transfer function using inertia.tfa: tf2 &lt;-
inertia.tfa(TF, vector=n0, d=c(0,0,0,1), e=c(0,0,1,0), prange=
seq(0,0.25,0.01))</p>
<p>Plot the transfer function using the same S3 method as before:
plot(tf2, cex.axis=0.8, ylim=c(3.9,4.43))</p>
<p>The sensitivity tangent for transfer function of inertia has an
intercept of equal to the relevant inertia (either using the same
population vector, or the correct bound), and a slope of the sensitivity
of the same transfer function. Calculate inertia of the desert tortoise
PPM using the population vector: inertia &lt;- inertia(TF,
vector=n0)</p>
<p>Calculate the sensitivity using the function ‘inertia.tfsens’: sens2
&lt;- inertia.tfsens(TF, vector=n0, d=c(0,0,0,1), e=c(0,0,1,0),
tolerance=1e-5)</p>
<p>(Here the ‘tolerance’ has had to be lowered to avoid calculation
error: try the function without that argument and it will have trouble
running)</p>
<p>Now add in the line, specifying the correct intercept and slope:
abline(inertia, sens2, lty=2, col=“red”)</p>
<div id="section-4" class="section level73">
<p class="heading"></p>
<p>FIGURE 4: TRANSFER FUNCTION MATRIX</p>
<p>This figure is designed to be 7” by 7” (Check size of plot window
using ‘par(din)’).</p>
<p>This is a nice, easy plot because the function does it all for you.
The functions ‘tfmat’ and ‘inertia.tfmat’ calculate a transfer function
for every PPM element. They are saved as arrays of values. The functions
are customisable: see ‘?tfmat’ and ‘?inertia.tfmat’.</p>
<p>Create the array for inertia, using a specific population vector: n0
&lt;- c(48, 16, 12, 10) tfmat &lt;- inertia.tfamatrix(TF, vector=n0)</p>
<p>…and plot it! plot(tfmat)</p>
<p>n0 &lt;- c(48, 16, 12, 10) tfmat &lt;- tfamatrix(TF)</p>
<p>…and plot it! plot(tfmat)</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
